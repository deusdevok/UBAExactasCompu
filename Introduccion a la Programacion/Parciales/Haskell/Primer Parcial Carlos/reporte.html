<h1>Parcial - tema2</h1>
<p>Nota: 9.0 / 10.0 (APROBADO)</p>
<pre><code>puntaje ej1: 2
puntaje ej2: 2
puntaje ej3: 2
puntaje ej4: 2
puntaje ej5: 0.0
puntaje ej6: 1
</code></pre>
<h2>Datos del alumno</h2>
<p>Nombre: Carlos Prado</p>
<p>DNI: 32759265</p>
<p>LU: 292/05</p>
<p>Maquina: 31-05</p>
<h2>Enunciado</h2>
<html>

<head>
  <link rel="icon" href="data:,">
  <link href="css/style.css" rel="stylesheet" />
  <meta charset="UTF-8">
</head>

<body>

<div>

<h1> Parcial Haskell - Tema 2 - Turno noche</h1>

<p>

<h2> Importante </h2>
Template de funciones a implementar <a href="#" onclick="forceDownload('/parcial/Template_t2.hs','SolucionT2.hs');">acá</a><br>
Lista de funciones permitidas <a href="/static/haskell_permitidas.html" target="_blank" rel="noopener noreferrer">acá</a><br>
Ejemplo de hunit <a href="#" onclick="forceDownload('/parcial/Test_template_t2.hs','Test_template_t2.hs');">acá</a>

<p>

<form name="form1" action="/submit_examen" method="post" enctype="multipart/form-data" onsubmit="return validaciones(event)">

<h2> Enunciado </h2>

<ol>
 <p>
  Resolver los siguientes ejercicios cuyas especificaciones en lenguaje
  semiformal figuran a continuación. Deben ser implementadas en Haskell utilizando los tipos
  requeridos y solamente las funciones que se ven en la materia Introducción a la Programación / Algoritmos y Estructuras de Datos I (FCEyN-UBA).
</p>

  <li> <strong>Ejercicio 1 (2 puntos)</strong></li>
  <p>problema mayorNumeroConNDivisores (<i>d</i>: Z, <i>h</i>: Z, <i>n</i>: Z) : Z {<br>
    &nbsp; <strong>requiere:</strong> {0 < d ∧ d ≤ h ∧ 0 < n} <br>
    &nbsp; <strong>requiere:</strong> {Existe al menos un número, en el rango [<i>d, h</i>], con exactamente <i>n</i> divisores positivos} <br>
    &nbsp; <strong>asegura:</strong> {d ≤ <i>res</i> ∧ <i>res</i> ≤ h} <br>
    &nbsp; <strong>asegura:</strong> {<i>res</i> tiene exactamente <i>n</i> divisores positivos} <br>
    &nbsp; <strong>asegura:</strong> {No existe un número con exactamente <i>n</i> divisores positivos en el rango [<i>res</i> + 1, <i>h</i>]} <br>
    }<br>
  </p>

  <pre style="background-color: #f0f0f0; /* Color de fondo del recuadro */
  padding: 2px; /* Espacio interior */
  border: 1px solid #ccc; /* Borde del recuadro */
  border-radius: 5px; /* Bordes redondeados */">
  Ejemplo 1: <b>mayorNumeroConNDivisores 2 5 3</b> debe devolver <b>4</b>
  Ejemplo 2: <b>mayorNumeroConNDivisores 2 5 2</b> debe devolver <b>5</b>
  </pre>

  <li> <strong>Ejercicio 2 (2 puntos)</strong></li>
  <p>problema sanguchitoDeCerosMasGrande (<i>lista</i>: seq⟨Z⟩) : Z {<br>
    &nbsp; <strong>requiere:</strong> {|<i>lista</i>| ≥ 3} <br>
    &nbsp; <strong>asegura:</strong> {Si existe al menos un <i>i</i> en el rango de <i>lista</i> tal que <i>esSanguchitoDeCeros(lista, i)</i> es verdadero, entonces <i>res</i> es el mayor valor <i>lista[i]</i> que cumple que <i>esSanguchitoDeCeros(lista, i)</i> es verdadero} <br>
    &nbsp; <strong>asegura:</strong> {Si no existe ningún <i>i</i> en el rango de <i>lista</i> tal que <i>esSanguchitoDeCeros(lista, i)</i> es verdadero, entonces <i>res</i> = 0} <br>
    }<br>

    <p>problema esSanguchitoDeCeros (<i>lista</i>: seq⟨Z⟩, <i>i</i>: Z) : Bool {<br>
      &nbsp; <strong>asegura:</strong> {|<i>lista</i>| ≥ 3 ∧ <i>i</i> > 0 ∧ <i>i</i> < |<i>lista</i>|-1 ∧ <i>lista[i-1]</i> = 0 ∧ <i>lista[i+1]</i> = 0} <br>
      }<br>
  </p>

  <pre style="background-color: #f0f0f0; /* Color de fondo del recuadro */
  padding: 2px; /* Espacio interior */
  border: 1px solid #ccc; /* Borde del recuadro */
  border-radius: 5px; /* Bordes redondeados */">
  Ejemplo 1: <b>sanguchitoDeCerosMasGrande [0,5,0,2,0,1]</b> debe devolver <b>5</b>
  Ejemplo 2: <b>sanguchitoDeCerosMasGrande [1,0,3,1,0]</b> debe devolver <b>0</b>
  </pre>

  <li> <strong>Ejercicio 3 (2 puntos)</strong></li>
  <p>
    Una famosa plataforma de streaming nos envía un listado de series de TV con sus respectivas temporadas. Se desea armar una 
    estadística de la cantidad de temporadas de las series. Para ello nos piden armar una lista que agrupe todas las series que poseen 
    la misma cantidad de temporadas.
  </p>
  <p>problema agruparPorCantidadDeTemporadas (<i>lista</i>: seq⟨String x Z⟩) : seq⟨Z x seq⟨String⟩⟩ {<br>
    &nbsp; <strong>requiere:</strong> {Las primeras componentes de <i>lista</i> tienen longitud mayor estricta a cero} <br>
    &nbsp; <strong>requiere:</strong> {Las segundas componentes de <i>lista</i> son mayores estrictas a cero} <br>
    &nbsp; <strong>requiere:</strong> {Las primeras componentes de <i>lista</i> no están repetidas en otras tuplas de la lista} <br>

    &nbsp; <strong>asegura:</strong> {Las primeras componentes de <i>res</i> son todas distintas} <br>
    &nbsp; <strong>asegura:</strong> {Si en <i>lista</i> hay una o más series con una cantidad de temporadas <i>t</i>, habrá 
      un elemento <i>e</i> ∈ <i>res</i> tal que e<sub>0</sub> = <i>t</i>} <br>
    &nbsp; <strong>asegura:</strong> {Todos los elementos de <i>res</i> son tuplas donde la primera componente 
      corresponde a la cantidad de temporadas de alguna serie de <i>lista</i>, y la segunda componente son todas las series
    de <i>lista</i> que tienen esa cantidad de temporadas} <br>
    }<br>
  </p>

  <pre style="background-color: #f0f0f0; /* Color de fondo del recuadro */
  padding: 2px; /* Espacio interior */
  border: 1px solid #ccc; /* Borde del recuadro */
  border-radius: 5px; /* Bordes redondeados */">
  Ejemplo 1: <b>agruparPorCantidadDeTemporadas [("Lost",6),("Friends", 10),("Bojack",6)]</b> puede devolver <b>[(6,["Lost","Bojack"]),(10,["Friends"])]</b>
  </pre>

  <li> <strong>Ejercicio 4 (2 puntos)</strong></li>
  <p>problema reemplazarMinimoDeCadaFila (<i>mat</i>: seq⟨seq⟨Z⟩⟩, <i>valor</i>: Z) : seq⟨seq⟨Z⟩⟩ {<br>
    &nbsp; <strong>requiere:</strong> {|<i>mat</i>| > 0} <br>
    &nbsp; <strong>requiere:</strong> {Todos los elementos de <i>mat</i> tienen la misma longitud (y dicha longitud es estrictamente mayor a 0)} <br>
    &nbsp; <strong>asegura:</strong> {|<i>res</i>| = |<i>mat</i>| ∧ para todo <i>i</i> tal que 0 ≤ i < |mat| se cumple que |<i>res</i>[i]| = |<i>mat</i>[i]|} <br>
    &nbsp; <strong>asegura:</strong> {Cada secuencia <i>res</i>[i] es igual a <i>mat</i>[i]</i> en todos sus elementos excepto en el/los mínimo/s, que son reemplazados
      por <i>valor</i>} <br>
    }<br>
  </p>

  <pre style="background-color: #f0f0f0; /* Color de fondo del recuadro */
  padding: 2px; /* Espacio interior */
  border: 1px solid #ccc; /* Borde del recuadro */
  border-radius: 5px; /* Bordes redondeados */">
  Ejemplo 1: <b>reemplazarMinimoDeCadaFila [[3,1],[2,2],[7,0]] 0</b> debe devolver <b>[[3,0],[0,0],[7,0]]</b>
  </pre>

  <li>
    <strong>Ejercicio 5 (1 punto)</strong>
    <p>
      Conteste marcando la opción correcta asumiendo que &alpha; y &beta; son dos fórmulas de la lógica proposicional 
      tales que &alpha; es más fuerte que &beta;, y que se tiene las siguientes especificaciones:
    </p>

     <table style="width: 100%; border-collapse: collapse;">
       <tr>
         <td style="width: 50%; padding: 10px; vertical-align: top;">
           <strong>problema1 (...)</strong> {<br>
           &nbsp; <strong>requiere:</strong> {True} <br>
           &nbsp; <strong>asegura:</strong> {&alpha;} <br>
           }
         </td>
         <td style="width: 50%; padding: 10px; vertical-align: top;">
           <strong>problema2 (...)</strong> {<br>
           &nbsp; <strong>requiere:</strong> {True} <br>
           &nbsp; <strong>asegura:</strong> {&beta;} <br>
           }
         </td>
       </tr>
     </table>
    <p>
      <input type="radio" name="mchoice_1" id="opcion1" value="1" />
      <label for="opcion1">El conjunto de soluciones de <b>problema1</b> está contenido dentro del conjunto de soluciones de <b>problema2</b></label>. <br>
      <input type="radio" name="mchoice_1" id="opcion2" value="2" />
      <label for="opcion2">El conjunto de soluciones de <b>problema2</b> está contenido dentro del conjunto de soluciones de <b>problema1</b></label>. <br>
      <input type="radio" name="mchoice_1" id="opcion3" value="3" />
      <label for="opcion3">No es posible afirmar ninguna de las opciones sin conocer en detalle ambas especificaciones</label>. <br>
    </p>
  </li>

  <li>
    <strong>Ejercicio 6 (1 punto)</strong>
    <p>
      Respecto al testing de caja negra, conteste marcando la opción correcta asumiendo que se cuenta con la siguiente especificación:
    </p>

    <p>
      problema unaFuncionQueHaceAlgo (<i>n</i>: Z) : Z {<br>
      &nbsp; <strong>requiere:</strong> {Existe algún número entero <i>x</i> tal que <i>x</i>*<i>x</i> = <i>n</i>} <br>
      &nbsp; <strong>asegura:</strong> {<i>res</i>*<i>res</i> = <i>n</i>} <br>
      }<br>
    </p>

    <p>
      <input type="radio" name="mchoice_2" id="opcion1_2" value="1" />
      <label for="opcion1_2"><i>n</i> = 10, <i>res</i> = &radic;<span style="border-top: 1px solid black;">10</span> es un caso de test válido</label>. <br>
      <input type="radio" name="mchoice_2" id="opcion2_2" value="2" />
      <label for="opcion2_2"><i>n</i> = 4, <i>res</i> = 2 es un caso de test válido</label>. <br>
      <input type="radio" name="mchoice_2" id="opcion3_2" value="3" />
      <label for="opcion3_2">Para testear el caso <i>n</i>=9, se debe considerar que el resultado podría ser -3 o 3</label>. <br>
    </p>
  </li>
</ol>



<hr>
<h3 style="color:#1A5276">Adjunta el archivo con tu solución:</h3>
<p><b style="color:red">Solo se puede adjuntar 1 archivo de extensión .hs. En caso de haber desarrollado tests propios, no deben ser entregados.</b></p>

<label for="archivo">Seleccionar archivo a enviar:</label>
<input type="file" id="archivo" name="archivo" required accept=".hs,text/x-haskell" />

<input type="submit" value="Enviar" style="background-color: #1A5276; border-radius: 5px;
          margin-top:10px;padding: 10px 150px;color: #FFFFFF;
          font-size: 20px;cursor: pointer; width:100%">
</form>
</div>

<script>
function validaciones(event) {
var confirmacion = confirm("Confirmo que revise mis respuestas y que quiero entregar mi examen");
if (!confirmacion) {
  event.preventDefault();
  event.returnValue = false;
  return false;
}
event.returnValue = true;
return true;
}

// registro una funcion para mostrar el archivo cuando se adjunta.
// de esa forma evitamos que se adjunten otros archivos por error
document
.getElementById('archivo')
.addEventListener(
  'change',
  function () {
    var fr = new FileReader();
    fr.onload = function () {
      alert(this.result);
    };
    fr.readAsText(this.files[0]);
  }
);

// para forzar a bajar el template de hunit y que no se pueda abrir en un nuevo tab
// (el browser intenta mostrar el codigo como HTML y el formato se ve raro)
function forceDownload(url, filename) {
fetch(url).then(function (t) {
  return t.blob().then((b) => {
    var a = document.createElement("a");
    a.href = URL.createObjectURL(b);
    a.setAttribute("download", filename);
    a.click();
  });
});
}
</script>
</body>
</html>

<h2>Solucion entregada por el alumno</h2>
<pre><code>{--
Yo: Carlos Prado
Certifico que el siguiente archivo fue elaborado únicamente por mí, sin ayuda de otras personas o herramientas.
--}


module SolucionT2 where

-- Ejercicio 1
mayorNumeroConNDivisores :: Integer -&gt; Integer -&gt; Integer -&gt; Integer
mayorNumeroConNDivisores d h n
    | h &lt; d = 0
    | numeroDivisores h == n = h
    | otherwise = mayorNumeroConNDivisores d (h-1) n

numeroDivisores :: Integer -&gt; Integer
numeroDivisores n = numeroDivisoresHasta n n

numeroDivisoresHasta :: Integer -&gt; Integer -&gt; Integer
numeroDivisoresHasta n 1 = 1
numeroDivisoresHasta n h
    | mod n h == 0 = 1 + numeroDivisoresHasta n (h-1)
    | otherwise = numeroDivisoresHasta n (h-1)

-- Ejercicio 2
sanguchitoDeCerosMasGrande :: [Integer] -&gt; Integer
sanguchitoDeCerosMasGrande xs = sangucheMasGrandeEntre xs 2 (longitud xs - 1)

sangucheMasGrandeEntre :: [Integer] -&gt; Integer -&gt; Integer -&gt; Integer
sangucheMasGrandeEntre (x:xs) d h
    | d &gt; h = 0
    | esSanguchitoDeCeros (x:xs) d = maximo (elemento (x:xs) d) resto
    | otherwise = resto
    where resto = sangucheMasGrandeEntre (x:xs) (d+1) h

elemento :: [Integer] -&gt; Integer -&gt; Integer
elemento (x:xs) 1 = x
elemento (x:xs) n = elemento xs (n-1)

esSanguchitoDeCeros :: [Integer] -&gt; Integer -&gt; Bool
esSanguchitoDeCeros (x:y:[]) _ = False
esSanguchitoDeCeros xs 0 = False
esSanguchitoDeCeros (x:y:z:xs) i
    | i &gt;= (longitud (x:y:z:xs)) = False
    | i == 2 &amp;&amp; x == 0 &amp;&amp; z == 0 = True
    | otherwise = esSanguchitoDeCeros (y:z:xs) (i-1)

longitud :: [Integer] -&gt; Integer
longitud [] = 0
longitud (x:xs) = 1 + longitud xs

maximo :: Integer -&gt; Integer -&gt; Integer
maximo x y
    | x &gt; y = x
    | otherwise = y

-- Ejercicio 3
agruparPorCantidadDeTemporadas :: [(String, Integer)] -&gt; [(Integer, [String])]
agruparPorCantidadDeTemporadas [] = []
agruparPorCantidadDeTemporadas ((nombre, cantTemporadas):series) = agregarOActualizar nombre cantTemporadas (agruparPorCantidadDeTemporadas series)

agregarOActualizar :: String -&gt; Integer -&gt; [(Integer, [String])] -&gt; [(Integer, [String])]
agregarOActualizar nombre cantTemporadas [] = [(cantTemporadas, [nombre])]
agregarOActualizar nombre cantTemporadas ((c,nombres):series)
    | cantTemporadas == c = ((c,(nombre:nombres)):series)
    | otherwise = (c,nombres) : agregarOActualizar nombre cantTemporadas series

-- Ejercicio 4
reemplazarMinimoDeCadaFila :: [[Integer]] -&gt; Integer -&gt; [[Integer]]
reemplazarMinimoDeCadaFila [] _ = []
reemplazarMinimoDeCadaFila (x:xs) n = reemplazarMinimoFila x n : reemplazarMinimoDeCadaFila xs n

reemplazarMinimoFila :: [Integer] -&gt; Integer -&gt; [Integer]
reemplazarMinimoFila xs n = reemplazarNporMEnFila (minimoFila xs) n xs

reemplazarNporMEnFila :: Integer -&gt; Integer -&gt; [Integer] -&gt; [Integer]
reemplazarNporMEnFila _ _ [] = []
reemplazarNporMEnFila n m (x:xs)
    | x == n = m : reemplazarNporMEnFila n m xs
    | otherwise = x : reemplazarNporMEnFila n m xs

minimoFila :: [Integer] -&gt; Integer
minimoFila [x] = x
minimoFila (x:xs)
    | x &lt; minimoFila xs = x
    | otherwise = minimoFila xs

{--
Siendo la última modificación con la solución final:
COMPLETE FECHA y HORA DE ULTIMA MODIFICACIÓN ACA
1 de Octubre de 2025, 19:43
--}

</code></pre>
<h2>Resultado de la compilacion</h2>
<pre><code>Loaded package environment from /home/olimar/.ghc/x86_64-linux-9.4.7/environments/default
[1 of 1] Compiling SolucionT2       ( correcciones/parcial_tn_funcional/prado_carlos_32759265/submission.hs.main.hs, correcciones/parcial_tn_funcional/prado_carlos_32759265/submission.hs.main.o )

</code></pre>
<h2>Ejecucion de los tests</h2>
<h3>tema2-test-ej1.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 8  Tried: 1  Errors: 0  Failures: 0

Cases: 8  Tried: 2  Errors: 0  Failures: 0

Cases: 8  Tried: 3  Errors: 0  Failures: 0

Cases: 8  Tried: 4  Errors: 0  Failures: 0

Cases: 8  Tried: 5  Errors: 0  Failures: 0

Cases: 8  Tried: 6  Errors: 0  Failures: 0

Cases: 8  Tried: 7  Errors: 0  Failures: 0


Cases: 8  Tried: 8  Errors: 0  Failures: 0


Cases: 8  Tried: 8  Errors: 0  Failures: 0

</code></pre>
<h3>tema2-test-ej2.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 6  Tried: 1  Errors: 0  Failures: 0

Cases: 6  Tried: 2  Errors: 0  Failures: 0

Cases: 6  Tried: 3  Errors: 0  Failures: 0

Cases: 6  Tried: 4  Errors: 0  Failures: 0

Cases: 6  Tried: 5  Errors: 0  Failures: 0


Cases: 6  Tried: 6  Errors: 0  Failures: 0


Cases: 6  Tried: 6  Errors: 0  Failures: 0

</code></pre>
<h3>tema2-test-ej3.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 6  Tried: 1  Errors: 0  Failures: 0

Cases: 6  Tried: 2  Errors: 0  Failures: 0

Cases: 6  Tried: 3  Errors: 0  Failures: 0

Cases: 6  Tried: 4  Errors: 0  Failures: 0

Cases: 6  Tried: 5  Errors: 0  Failures: 0


Cases: 6  Tried: 6  Errors: 0  Failures: 0


Cases: 6  Tried: 6  Errors: 0  Failures: 0

</code></pre>
<h3>tema2-test-ej4.hs.compilacion.out</h3>
<p>Puntaje del ej: 2 / 2</p>
<pre><code>

Cases: 9  Tried: 1  Errors: 0  Failures: 0

Cases: 9  Tried: 2  Errors: 0  Failures: 0

Cases: 9  Tried: 3  Errors: 0  Failures: 0

Cases: 9  Tried: 4  Errors: 0  Failures: 0

Cases: 9  Tried: 5  Errors: 0  Failures: 0

Cases: 9  Tried: 6  Errors: 0  Failures: 0

Cases: 9  Tried: 7  Errors: 0  Failures: 0

Cases: 9  Tried: 8  Errors: 0  Failures: 0


Cases: 9  Tried: 9  Errors: 0  Failures: 0


Cases: 9  Tried: 9  Errors: 0  Failures: 0

</code></pre>
<h3>mchoice.json-ej5.compilacion.out</h3>
<p>Puntaje del ej: 0.0 / 1</p>
<pre><code>mchoice ej5: respuesta del alumno=2, respuesta correcta=1

Ran 1 test in 0 seconds

FAILED (failures=1)

</code></pre>
<h3>mchoice.json-ej6.compilacion.out</h3>
<p>Puntaje del ej: 1 / 1</p>
<pre><code>mchoice ej6: respuesta del alumno=3, respuesta correcta=3

Ran 1 test in 0 seconds

OK

</code></pre>
<p>FIN</p>